tiktok-lambda-toxicity/
├── README.md
├── requirements.txt                  # kafka-python, pyspark, transformers, torch, psycopg2, etc.
├── docker-compose.yml                # Kafka + Zookeeper + PostgreSQL (dev)
├── config/
│   └── config.yaml                       # Config chung: kafka, postgres, model
├── src/
│   ├── ingestion/
│   │   └── json_to_kafka.py              # Đọc file JSON → push Kafka
│   ├── speed_layer/
│   │   └── streaming_toxicity.py         # Spark Structured Streaming (realtime)
│   ├── batch_layer/
│   │   └── batch_full_recompute.py       # Spark Batch hàng ngày (cron)
│   ├── models/
│   │   └── toxicity_detector.py          # Wrapper ViHateT5
│   └── utils/
│       └── db_utils.py                   # JDBC write to PostgreSQL
├── scripts/
│   ├── start_streaming.sh                # Chạy Speed Layer
│   └── run_batch.sh                      # Chạy Batch Layer (gọi từ cron)
└── sql/
    └── serving_views.sql                 # PostgreSQL views merge batch + speed

Yêu cầu Cursor: Generate toàn bộ file theo cấu trúc này, code Python chạy được.