# src/ingestion/json_to_kafka.py

Viết một Kafka Producer ổn định với các yêu cầu:
- Đọc tất cả file .jsonl trong thư mục /data/raw
- Mỗi dòng là 1 video JSON (video_id, caption, comments[], hashtags[], etc.)
- Push vào Kafka topic "tiktok-raw" với key = video_id
- Có xử lý file đã processed (thư mục /data/processed và /data/failed)
- Retry, logging rõ ràng, compression gzip
- Loop vô hạn, poll mỗi 10 giây tìm file mới
- Dùng kafka-python

Schema mẫu JSON line:
{"video_id": "123", "caption": "...", "comments": [{"user_id": "...", "text": "..."}], "hashtags": ["fyp"], ...}